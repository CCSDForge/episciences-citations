{% extends 'base.html.twig' %}

{% block title %}Hello ExtractController!{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('extract') }}
{% endblock %}
{% block body %}
    <div class="flex w-full">
        <iframe class="w-screen h-full min-h-screen " src="{{ path("app_get_pdf",{ 'docId': form.id.vars.value }) }}"
                allow="fullscreen"></iframe>
        {{ form_start(form) }}
        <div id="sortref" class="flex-1 w-auto">
            {% for paperReferences in form.paperReferences %}
                <div class="list-none{% if paperReferences.vars.value.accepted is same as(0) %} hidden{% endif %}"
                     data-idref="{{ paperReferences.id.vars.value }}">
                    <i class="fa-solid fa-up-down-left-right handle" aria-hidden="true"></i>
                    {{ form_widget(paperReferences.reference,{'attr':{'class': "hidden"}}) }}
                    {% set jsonDecodedRef = prettyReference(paperReferences.reference.vars.data) %}
                    <p>{{ jsonDecodedRef['raw_reference'] }}</p>
                    {% if jsonDecodedRef['doi'] is defined %}
                        <a href="https://doi.org/{{ jsonDecodedRef['doi'] }}"
                           class="underline text-blue-600 hover:text-blue-800 visited:text-purple-600" rel="noopener"
                           target="_blank">{{ jsonDecodedRef['doi'] }}</a>
                    {% endif %}
                    <div class="hidden" id="radio-group-choice-{{ paperReferences.id.vars.value }}">{{ form_widget(paperReferences.accepted) }}</div>
                    <label class="relative inline-flex items-center mr-5 cursor-pointer">
                        <input id="toggle-input" type="checkbox" value="{{ paperReferences.id.vars.value }}" class="sr-only peer" {% if paperReferences.accepted.vars.data is same as(1) %} checked {% endif %}>
                        <div class="w-11 h-6 bg-gray-200 rounded-full peer dark:bg-red-700 peer-focus:ring-4
                        peer-focus:ring-green-300 dark:peer-focus:ring-green-800 peer-checked:after:translate-x-full
                        peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px]
                        after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all
                        dark:border-gray-600 peer-checked:bg-green-600"></div>
                    </label>
                    <span>{{ form_row(paperReferences.reference_order) }}</span>
                    <span>{{ form_row(paperReferences.id) }}</span>
                </div>
            {% endfor %}
            {{ form_row(form.save,{'attr': {'class':"bg-transparent
            hover:bg-emerald-500
            text-emerald-400
            font-semibold
            hover:text-white
            py-2 px-4 border
            border-emerald-500
            hover:border-transparent
            rounded"}}) }}
        </div>
        {{ form_end(form) }}
    </div>
{% endblock %}